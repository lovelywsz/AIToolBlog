import{a as b,_ as F,u as V,b as E,f as T,g as N,c as A,d as S,l as P,e as q,h as z}from"./index-G82DOdH0.js";import{M as H}from"./markdown-it-BMSQkwth.js";import{a as O,p as X,s as Z}from"./element-plus-yQA3I_5B.js";import{r as L,d as D,ah as a,m as g,p as h,q as n,U as o,O as c,S as m,F as x,a7 as j,T as r,u,M as G,R as J,Z as K,X as Q,ad as W}from"./vue-ChzjY1xf.js";const U="/api/blogs",Y=async _=>{try{return await b.get(`${U}/${_}/comments`)}catch(s){throw console.error("Error fetching comments:",s),s}},ee=async(_,s)=>{try{return await b.post(`${U}/${_}/comments`,{content:s})}catch(e){throw console.error("Error creating comment:",e),e}},te=async _=>{try{return await b.delete(`/api/comments/${_}`)}catch(s){throw console.error("Error deleting comment:",s),s}},oe={class:"comment-form"},ne={class:"comment-list"},se={class:"comment-item-header"},ae={class:"right"},ce={class:"comment-item-content"},re={__name:"CommentView",setup(_){const e=V().params.id||"",{userInfo:k}=E(),i=L([]);async function p(){const l=await Y(e);i.value=l}D(p);const y=async l=>{await O.confirm("确认删除该评论吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})&&(await te(l),p())},t=L({content:""}),B={content:[{required:!0,message:"请输入评论内容",trigger:"blur"}]},w=async()=>{await ee(e,t.value),t.value.content="",p()};return(l,f)=>{const C=a("el-input"),v=a("el-form-item"),$=a("el-button"),I=a("el-form"),M=a("User"),R=a("el-icon");return g(),h(x,null,[n("div",oe,[o(I,{model:t.value,ref:"commentFormRef",rules:B,"label-width":"80px"},{default:c(()=>[o(v,{label:"发表评论",prop:"content"},{default:c(()=>[o(C,{type:"textarea",modelValue:t.value.content,"onUpdate:modelValue":f[0]||(f[0]=d=>t.value.content=d),placeholder:"请输入评论内容"},null,8,["modelValue"])]),_:1}),o(v,null,{default:c(()=>[o($,{type:"primary",onClick:w},{default:c(()=>[m("评论")]),_:1})]),_:1})]),_:1},8,["model"])]),n("div",ne,[(g(!0),h(x,null,j(i.value,d=>(g(),h("div",{class:"comment-item",key:d.id},[n("div",se,[n("span",null,[o(R,null,{default:c(()=>[o(M)]),_:1}),m(r(d.authorNickname),1)]),n("span",null,r(u(T)(d.createdAt)),1),n("div",ae,[d.authorNickname===u(k).nickname?(g(),G($,{key:0,link:"",type:"primary",onClick:he=>y(d.id)},{default:c(()=>[m("删除")]),_:2},1032,["onClick"])):J("",!0)])]),n("div",ce,r(d.content),1)]))),128))])],64)}}},ie=F(re,[["__scopeId","data-v-953d4b8e"]]),le={class:"blog-detail"},de={class:"title"},me={class:"intro"},_e={class:"author"},ue={class:"category"},pe={class:"time"},fe=["innerHTML"],ve={class:"blog-footer"},ge={__name:"BlogDetailView",setup(_){const s=V(),e=K({}),k=new H,i=s.params.id||"";D(async()=>{const t=await N(i);e.title=t.title,e.content=t.content,e.author=t.author,e.category=t.category,e.updatedAt=t.updatedAt,e.likes=t.likes,e.favorites=t.favorites,e.comments=t.comments,e.id=t.id,e.description=t.description,e.isFavorited=t.isFavorited,e.isLiked=t.isLiked}),A(Q(e,"title"));const p=async()=>{e.isLiked?(await S(i),e.likes-=1,e.isLiked=!1):(await P(i),e.likes+=1,e.isLiked=!0)},y=async()=>{e.isFavorited?(await q(i),e.favorites-=1,e.isFavorited=!1):(await z(i),e.favorites+=1,e.isFavorited=!0)};return(t,B)=>{const w=a("User"),l=a("el-icon"),f=a("PriceTag"),C=a("Clock"),v=a("el-button");return g(),h("div",le,[n("h1",de,r(e.title),1),n("div",me,[n("div",_e,[o(l,null,{default:c(()=>[o(w)]),_:1}),m(" "+r(e.author),1)]),n("div",ue,[o(l,null,{default:c(()=>[o(f)]),_:1}),m(" "+r(e.category),1)]),n("div",pe,[o(l,null,{default:c(()=>[o(C)]),_:1}),m(" "+r(u(T)(e.updatedAt)),1)])]),n("div",{class:"content",innerHTML:u(k).render(W(e.content)||"")},null,8,fe),n("div",ve,[o(v,{type:e.isLiked?"primary":"default",icon:u(X),size:"large",onClick:p},{default:c(()=>[m(r(e.likes)+"点赞 ",1)]),_:1},8,["type","icon"]),o(v,{type:e.isFavorited?"primary":"default",icon:u(Z),size:"large",onClick:y},{default:c(()=>[m(r(e.favorites)+"收藏 ",1)]),_:1},8,["type","icon"])]),o(ie)])}}},be=F(ge,[["__scopeId","data-v-b76d00d1"]]);export{be as default};
